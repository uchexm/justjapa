# Database ERD - Simplified

```mermaid
erDiagram
    users {
        UUID PK id
        VARCHAR email
        VARCHAR firstName
        VARCHAR lastName
        VARCHAR passwordHash
        BOOLEAN isActive
        ENUM type "client|agent|consultant|admin|super_admin"
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    user_profiles {
        UUID PK id
        UUID FK userId
        ENUM userType "client|agent|consultant|admin|super_admin"
        ENUM status "pending|active|suspended|locked|deactivated|rejected"
        ENUM approvalStatus "not_required|pending|approved|rejected|under_review"
        TEXT approvalNotes
        JSONB submittedDocuments
        INTEGER yearsOfExperience
        JSONB certifications
        JSONB languages
        VARCHAR country
        VARCHAR state
        VARCHAR city
        VARCHAR businessName
        BOOLEAN emailNotifications
        BOOLEAN smsNotifications
        JSONB preferences
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    roles {
        UUID PK id
        VARCHAR name
        VARCHAR description
        BOOLEAN isActive
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    permissions {
        UUID PK id
        VARCHAR name
        VARCHAR description
        VARCHAR resource
        VARCHAR action
        BOOLEAN isActive
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    access_tokens {
        UUID PK id
        UUID FK user_id
        VARCHAR token_hash
        ENUM token_type "access|refresh|reset|verify"
        ENUM scope "auth|reset_password|email_verification"
        TIMESTAMP expires_at
        TIMESTAMP revoked_at
        JSONB metadata
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    security_events {
        UUID PK id
        ENUM eventType "LOGIN_SUCCESS|LOGIN_FAILED|ACCOUNT_LOCKED|PASSWORD_CHANGED|EMAIL_VERIFIED|LOGOUT|SUSPICIOUS_LOGIN|RATE_LIMITED|BRUTE_FORCE_DETECTED|ADMIN_ACTION|PROFILE_UPDATED|ACCOUNT_DEACTIVATED"
        ENUM severity "LOW|MEDIUM|HIGH|CRITICAL"
        UUID FK userId
        VARCHAR ipAddress
        TEXT userAgent
        TEXT description
        JSONB metadata
        BOOLEAN resolved
        TIMESTAMP createdAt
        TIMESTAMP updatedAt
    }

    user_roles {
        UUID PK userId
        UUID PK roleId
    }

    role_permissions {
        UUID PK roleId
        UUID PK permissionId
    }

    users ||--o{ user_profiles : "has profile"
    users ||--o{ access_tokens : "has tokens"
    users ||--o{ security_events : "generates events"
    users }o--o{ roles : "assigned roles"
    roles }o--o{ permissions : "has permissions"
```

*Simplified version for better GitHub rendering*
